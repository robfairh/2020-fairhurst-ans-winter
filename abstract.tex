\documentclass{anstrans}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{MHTGR-350 Moltres Benchmark}
\author{Roberto E. Fairhurst Agosta, Kathryn D. Huff}

\institute{
University of Illinois at Urbana-Champaign, Dept. of Nuclear, Plasma, and Radiological Engineering\\
ref3@illinois.edu
}

%%%% packages and definitions (optional)
\usepackage{graphicx} % allows inclusion of graphics
\usepackage{booktabs} % nice rules (thick lines) for tables
\usepackage{microtype} % improves typography for PDF
\usepackage{xspace}
\usepackage{tabularx}
\usepackage{floatrow}
\usepackage{subcaption}
\usepackage{enumitem}
\usepackage{placeins}
\usepackage{amsmath}
\usepackage{multirow}
\usepackage[acronym,toc]{glossaries}
\include{acros}
\makeglossaries

\usepackage[printwatermark]{xwatermark}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{lipsum}

\newcommand{\SN}{S$_N$}
\renewcommand{\vec}[1]{\bm{#1}} %vector is bold italic
\newcommand{\vd}{\bm{\cdot}} % slightly bold vector dot
\newcommand{\grad}{\vec{\nabla}} % gradient
\newcommand{\ud}{\mathop{}\!\mathrm{d}} % upright derivative symbol

\newcolumntype{c}{>{\hsize=.56\hsize}X}
\newcolumntype{b}{>{\hsize=.7\hsize}X}
\newcolumntype{s}{>{\hsize=.74\hsize}X}
\newcolumntype{f}{>{\hsize=.1\hsize}X}
\newcolumntype{a}{>{\hsize=.45\hsize}X}
%\usepackage[pagestyles]{titlesec}
%\titleformat*{\subsection}{\normalfont}
%\titleformat{\section}{\bfseries}{Item \thesection.\ }{0pt}{}

%\newwatermark[allpages,color=gray!50,angle=45,scale=3,xpos=0,ypos=0]{DRAFT}

\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Abstract}

\textit{
Moltres is a multi-physics tool for modeling coupled physics in nuclear reactors.
Its original purpose was the modeling of Molten Salt Reactors.
This work studies Moltres capabilities to model High Temperature Gas-Cooled Reactors.
With that purpose we will conduct Phase I: Exercise 1 of the OECD/NEA MHTGR-350 Benchmark.
}

\section{Introduction}

The history of \glspl{PMR} begins in the 1960s with the deployment of the Dragon reactor (1965) in the \gls{UK} and Peach Bottom (1966) in the \gls{US}.
Later, the Fort St. Vrain Generating Station (1976) in the \gls{US} laid the foundation for future prismatic \gls{HTGR} designs \cite{aris_iaea_general_2013}.
Modern \gls{HTGR} designs still use variants of its fuel assembly block.

The \gls{PMR} design concept has existed for some time.
However, the computational tools available for the analysis of \glspl{HTGR} have lagged behind, compared to the state of the art of other reactor technologies.
% However, the computational tools available for the analysis of \glspl{PMR} are a technology still under development.
% Compared to the state of the art of other reactor technologies, the tools available for \gls{PMR} have lagged behind.
% Nowadays there are several codes to solve \glspl{PMR}.
% They rely on different methods such as \gls{MC}, deterministic transport, and deterministic diffusion.
% We focus our interest in the last type.
% Deterministic diffusion solvers have lower computational requirements than other methods reference ??
The history of deterministic diffusion solvers begins in the late 1950s with the \gls{FDM} applied to \glspl{LWR}.
The computational expense associated with these calculations motivated the development of more computationally efficient techniques such as nodal methods \cite{lawrence_progress_1986}.
Some modern codes still use this technique.
DIF3D \cite{lawrence_dif3d_1983} and PARCS \cite{downar_parcs_2004} are examples of those codes.
In the 1970s, nodal methods proved to be a highly efficient and accurate technique in Cartesian geometries.
In 1981, a formulation based on \gls{NEM} first demonstrated the feasibility of nodal methods in hexagonal geometries \cite{duracz_nodal_1981}.
Nevertheless, this method introduces non-physical singular terms that requires the utilization of discontinuous polynomials.
This motivated the development of HEXNOD \cite{wagner_three-dimensional_1989} and HEXPEDITE \cite{fitzpatrick_hexpedite_1992}, more effective formulations introduced in the late 1980s and early 1990s.
Previous studies \cite{fitzpatrick_hexpedite_1992} \cite{ougouag_inherently_1993} \cite{fitzpatrick_developments_1995} have established HEXPEDITE's superiority in terms of accuracy and runtime over \gls{FDM} and \gls{NEM} \cite{ortensi_deterministic_2010}.
HEXPEDITE's use still prevails in the analysis of \glspl{HTGR} \cite{ortensi_deterministic_2010-1}.

Historically, linking a neutronics solver to a thermal-hydraulics solver allowed for the simulation of an entire reactor.
For example, coupling PARCS, DIREKT, and THERMIX \cite{seker_analysis_2006} allowed for solving the \gls{PBMR} \gls{OECD}/\gls{NEA}/\gls{NSC} Benchmark \cite{reitsma_oecdneansc_2006}.
Nonetheless, \glspl{HTGR} have a strong temperature feedback, causing increased coupling between the different physics phenomena.
Because of the large time-scale separation, multiphysics transient simulations coupled via the operator-splitting approach may introduce significant numerical errors \cite{ragusa_consistent_2009} \cite{park_tightly_2010}.
\gls{MOOSE} \cite{gaston_moose_2009} \cite{gaston_physics-based_2015} is a computational framework targeted at solving fully coupled systems and allows for great flexibility even with large variance in time scales.
An advantage associated with software built on the \gls{MOOSE} framework is that all applications share a common code base, which facilitates relatively easy coupling \cite{novak_pronghorn_2018}.
% RattleS$_n$ake \cite{wang_nonlinear_2013} has become the primary tool for solving the linearized Boltzmann neutron transport equation within \gls{MOOSE} \cite{strydom_inl_2013}. 
% RattleS$_n$ake counts with a variety of solvers available including low-order multigroup diffusion.
% Pronghorn \cite{bingham_pronghorn_2012} \cite{novak_pronghorn_2018} is a \gls{FEM} porous media thermal-hydraulics simulation code built on the \gls{MOOSE} framework.
\textit{Moltres} \cite{lindsay_introduction_2018} is a \gls{FEM} simulation code built on the \gls{MOOSE} framework.
It solves arbitrary-group neutron diffusion, precursor, and temperature governing equations on a single mesh.
% All codes use MPI for parallel communication and allow for deployement on massively-parallel cluster-computing platforms.
% MOOSE applications by default use monolithic and implicit methods ideal for closely-coupled and multi-scale physics.

In addition to the development of new methods, it is essential to define appropriate benchmarks to compare the capabilities of various computer codes.
The \gls{OECD} \gls{NEA} defined such benchmark for the \gls{MHTGR}-350 MW reactor \cite{oecd_nea_benchmark_2017}.
The scope of the benchmark is twofold: 1) to establish a well-defined problem, based on a common given data set, to compare methods and tools in core simulation and thermal fluids analysis, 2) to test the depletion capabilities of various lattice physics codes available for \glspl{PMR}.
The objective of this work is to conduct Exercise 1 of Phase I of the benchmark with Moltres.
Finally, we will compare the results to the already published results from the benchmark.

\section{Benchmark definition}

The MHTGR-350 is a General Atomics design developed in the 1980s \cite{silady_licensing_1988}.
This reactor forms the base of the reference design.
The benchmark specifies the fuel at the \gls{EOEC} core state because it leads to the highest decay heat load for the system and narrowest safety margins \cite{oecd_nea_benchmark_2017}.

The core consists of an array of hexagonal fuel elements in a cylindrical arrangement \ref{fig:radial}.
A ring of identically sized solid graphite replaceable reflector elements surrounds the fuel elements.
Then, a region of permanent reflector elements follows the replaceable reflectors.
Nineteen graphite replaceable reflector elements compose the inner reflector region.
The RPV encases all the elements.

Figure \ref{fig:axial} shows an axial view of the reactor.
The active core consists of hexagonal graphite fuel elements containing blind holes for fuel compacts and full-length channels for helium coolant flow.
Ten fuel elements stacked on top of each other compose the 66 fuel columns that integrate the active core.

Thirty reflector columns contain channels for \glspl{CR}.
Twelve columns in the core also contain channels for reserve shutdown borated graphite pellets.
If the \glspl{CR} become inoperable, the pellets drop into the channels.
% Hoppers house the pellets above the core.
% \cite{oecd_nea_benchmark_2017}

\begin{figure}[htbp!] %or H 
	\centering
	\includegraphics[width=0.95\linewidth]{figures/radial-layout.png}
	\hfill
	\caption{Core radial layout. Image reproduced from \cite{oecd_nea_benchmark_2017}.}
	\label{fig:radial}
\end{figure}

\begin{figure}[htbp!]
	\centering
	\includegraphics[width=0.95\linewidth]{figures/axial-layout.png}
	\hfill
	\caption{Core axial layout. Image reproduced from \cite{oecd_nea_benchmark_2017}.}
	\label{fig:axial}
\end{figure}

\subsection{Benchmark cases}

Several Phases and Exercises compose the benchmark.

\begin{itemize}
	\item Phase I: Steady State
        \begin{enumerate}
            \item Neutronics solution with fixed cross-sections. 
            \item Thermal fluids solution with given heat sources.
            \item Coupled neutronics-thermal fluids steady state solution.
        \end{enumerate}

        \item Phase II: Transient Cases
        \begin{enumerate}
            \item Depressurized Conduction Cooldown without reactor trip.
            \item Pressurized Conduction Cooldown with reactor trip.
            \item Water ingress with reactor trip.
            \item Power 100-80-100 load follow.
        \end{enumerate}

        \item Phase III: Lattice Depletion Case

\end{itemize}

As mentioned earlier, the scope of this work is Exercise 1 of Phase I.
Future studies will focus on the rest of the exercises of Phase I and, also, Phase II.
Phase III examines variations in lattice calculations.
We do not plan to conduct studies of such phase in the future.

\subsection{Phase I Exercise 1} % results or expected results ??

The benchmark specifies the cross-sections required to conduct the exercise in a separate file \textit{OECD-MHTGR350\_Simplified.xs}.
This ensures a common dataset among various benchmark participants.
A separate file \textit{xsmap.pdf} specifies a detailed map of the cross-section numbering.

The weighted multi-group macroscopic cross-sections were obtained using DRAGON-4 \cite{marleau_user_2016} from a full block configuration with a double heterogeneity treatment of the fuel \cite{oecd_nea_benchmark_2017}.
The dataset contains 26 energy groups.

% What should be reported \cite{oecd_nea_benchmark_2017}
The exercise requests the reporting of the global parameters: $K_{eff}$, \gls{CR} worth ($\Delta \rho_{CR}$), and axial offset ($AO$).
Average core power density, neutron-flux map, and a average power density map should be reported as well \cite{oecd_nea_benchmark_2017}.

Equations \ref{eq:controlrod} and \ref{eq:ao} define $\Delta \rho_{CR}$ and $AO$.
\begin{align}
    \Delta \rho_{CR} &= \frac{k_{out}-k_{in}}{k_{out}k_{in}}
\label{eq:controlrod}       
    \intertext{where}
    k_{out} &= \mbox{eigenvalue with \gls{CR} at position 1184.8 cm} \\
    k_{in} &= \mbox{eigenvalue with \gls{CR} at position 391.81 cm}
\intertext{and}
    AO &= (TP_{top}-TP_{bottom})/(TP_{top}+TP_{bottom})
\label{eq:ao}
    \intertext{where}
    TP_{top} &= \mbox{total power produced in the top half core} \\
    TP_{bottom} &= \mbox{total power produced in the bottom half core}
\end{align}

The participants of Phase I Exercise 1 of the benchmark were: \gls{INL}, \gls{UMICH}, \gls{KAERI}, \gls{SNU}, \gls{UNIST}, \gls{HZDR}, and \gls{GRS}, Table \ref{tab:participants}.
Table \ref{tab:results} shows the mean, the \gls{SD}, and the \gls{RSD}, equation \ref{eq:rsd}, of the reported global parameters.

\begin{align}
    RSD &= \frac{SD}{mean} 100
\label{eq:rsd}       
\end{align}

    \begin{table}[htbp!]
        \centering
        \caption{List of participants and codes used \cite{oecd_nea_coupled_2019}.}
        \label{tab:participants}
        \begin{tabular}{lll}
        \hline
        Organization  & Code        & Method                           \\ \hline
        \multirow{ 2}{*}{INL} & INSTANT & Hybrid \gls{FEM} P$_N$ transport \\
                      & Rattlesnake & \gls{FEM} diffusion              \\
        UMICH         & PARCS       & \gls{NEM} diffusion              \\
        KAERI         & CAPP        & \gls{FEM} diffusion              \\
        SNU           & McCARD      & \gls{MC} transport               \\
        UNIST         & MCS         & \gls{MC} transport               \\
        HZDR          & DYN3D       & Nodal simplified P$_N$ transport \\
        \multirow{ 2}{*}{GRS} & DIF3D    & Finite volume diffusion     \\
                      & PARCS       & \gls{NEM} diffusion              \\ \hline
        \end{tabular}
    \end{table}

    \begin{table}[htbp!]
        \centering
        \caption{Mean, SD, and RSD for global parameters \cite{oecd_nea_coupled_2019}.}
        \label{tab:results}
        \begin{tabular}{lllll}
        % \small
        \hline
        Method &        & $k_{eff}$ & $\Delta \rho_{CR}$ & $AO$ \\
        % &	& 	& (pcm) &  \\
        \hline
        \multirow{ 3}{*}{Diffusion} & Mean & 1.06691 & 822.1 pcm & 0.168 \\
               & SD              & $4.19 \times 10^{-4}$ & 2.05 & $3.66 \times 10^{-3}$ \\
               & RSD             & $3.93 \times 10^{-2}$ & 0.25 & 2.18 \\ \hline

        \multirow{ 3}{*}{Transport} & Mean & 1.06882 & 850.3 pcm & 0.166 \\
               & SD              & $6.43 \times 10^{-5}$ & 3.20 & $2.34 \times 10^{-3}$ \\
               & RSD             & $6.02 \times 10^{-3}$ & 0.376 & 1.41 \\ \hline

        \multirow{ 3}{*}{All} & Mean & 1.06743 & 829.8 pcm & 0.167 \\
               & SD              & $9.26 \times 10^{-4}$ & 12.8 & $3.49 \times 10^{-3}$ \\
               & RSD             & $8.67 \times 10^{-2}$ & 1.54 & 2.08 \\ \hline

        \end{tabular}
    \end{table}

Overall, the results among the participants show good agreement among the codes based on the same method.
The results of the fundamental mode eigenvalue have a \gls{RSD} below 0.1\%.
The calculations of the \gls{CR} worth shows good agreement as well and the \gls{RSD} is below 0.4\%.
The variability in the axial offset calculation is higher, but still shows good agreement.
For a more thorough discussion and the rest of the results of the exercise refer to \cite{oecd_nea_coupled_2019}.

\section{Moltres}

Moltres is an open source simulation tool originally developed for simulating \glspl{MSR} in the context of the \gls{MOOSE} finite element modeling framework.
Moltres defines physics kernels and boundary conditions that solve arbitrary-group neutron diffusion, precursor, and temperature governing equations on a single mesh from one to three dimensions.
In \gls{MOOSE} jargon, kernels are C++ classes that contain methods for computing residual and Jacobian contributions corresponding to individual pieces of governing equations \cite{lindsay_introduction_2018}.

In Moltres, the time-dependent multi-group diffusion equation, equation \ref{eq:diffusion}, describes the group $g$ neutron flux.

\begin{align}
        \frac{1}{v_g}\frac{\partial}{\partial t} \phi_g &= \nabla \cdot D_g
        \nabla \phi_g - \Sigma_g^r \phi_g \sum_{g \ne g'}^G
        \Sigma_{g'\rightarrow g}^s \phi_{g'} + \notag\\
        &\phantom{{}=1}\chi_g^p \sum_{g' = 1}^G (1 - \beta) \nu \Sigma_{g'}^f \phi_{g'} + 
        \chi_g^d \sum_i^I \lambda_i C_i
\label{eq:diffusion}
        \intertext{where}
        v_g &= \mbox{group $g$ neutron speed} \\
        \phi_g &= \mbox{group $g$ neutron flux} \\
        t &= \mbox{time} \\
        D_g &= \mbox{group $g$ diffusion coefficient} \\
        \Sigma_g^r &= \mbox{group $g$ macroscopic removal cross-section} \\
        \Sigma_{g'\rightarrow g}^s &= \mbox{group $g'$ to group $g$ macroscopic scattering} \notag \\
		&\phantom{{}=1} \mbox{cross-section}\\
        \chi_g^p &= \mbox{group $g$ prompt fission spectrum} \\
        G &= \mbox{number of discrete energy groups} \\
        \nu &= \mbox{number of neutrons produced per fission} \\
        \Sigma_g^f &= \mbox{group $g$ macroscopic fission cross-section} \\
        \chi_g^d &= \mbox{group $g$ delayed fission spectrum} \\
        I &= \mbox{number of delayed neutron precursor groups} \\
        \beta &= \mbox{delayed neutron fraction}\\
        \lambda_i &= \mbox{average decay constant of delayed neutron} \notag\\
        &\phantom{{}=1} \mbox{precursors in precursor group $i$} \\
        C_i &= \mbox{concentration of delayed neutron precursors} \notag \\
        &\phantom{{}=1} \mbox{in precursor group $i$}.
\end{align}

Equation \ref{eq:precursors} describes the delayed neutron precursors.

\begin{align}
        \frac{\partial C_i}{\partial t} &= \sum_{g'= 1}^G \beta_i \nu
        \Sigma_{g'}^f \phi_{g'} - \lambda_i C_i
\label{eq:precursors}
\end{align}

As mentioned earlier, Moltres is also capable of solving for the temperature.
This study does not use such capability as Exercise 1 of Phase I of the benchmark uses fixed cross-sections.

\section{Conclusion}

OECD/NEA defined a benchmark to compare methods and tools for studying \glspl{PMR}.
The benchmark defines a reference design based on the MHTGR-350 design from General Atomics.
The benchmark comprises three phases and several exercises.
This study intends to complete Exercise 1 of Phase I using Moltres.
Although the original purpose of Moltres is the analysis of \glspl{MSR}, through this exercise we will demonstrate the analysis of \glspl{PMR} using Moltres.

\section{Acknowledgements}

Roberto E. Fairhurst Agosta and Prof. Huff are supported by the \gls{NRC} Faculty Development Program (award NRC-HQ-84-14-G-0054 Program B) and the Department of Nuclear, Plasma, and Radiological Engineering.
Prof. Huff is also supported by the Nuclear Regulatory Commission Faculty Development Program (award NRC-HQ-84-14-G-0054 Program B), the Blue Waters sustained-petascale computing project supported by the National Science Foundation (awards OCI-0725070 and ACI-1238993) and the state of Illinois, the DOE ARPA-E MEITNER Program (award DE-AR0000983), and the DOE H2@Scale Program (Award Number: DE-EE0008832)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{ans}
\bibliography{bibliography}
\end{document}